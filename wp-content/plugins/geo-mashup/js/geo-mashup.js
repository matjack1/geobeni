var GeoMashup,customizeGeoMashup,customizeGeoMashupMap,customGeoMashupColorIcon,customGeoMashupCategoryIcon,customGeoMashupSinglePostIcon,customGeoMashupMultiplePostImage;GeoMashup={opts:{},actions:{},objects:{},object_count:0,locations:{},open_attachments:[],errors:[],color_names:["red","lime","blue","orange","yellow","aqua","green","silver","maroon","olive","navy","purple","gray","teal","fuchsia","white","black"],colors:{red:"#ff071e",lime:"#62d962",blue:"#9595ff",orange:"#fe8f00",yellow:"#f2f261",aqua:"#8eeff0",green:"#459234",silver:"#c2c2c2",maroon:"#ae1a40",olive:"#9f9b46",navy:"#30389d",purple:"#a54086",gray:"#9b9b9b",teal:"#13957b",fuchsia:"#e550e5",white:"#ffffff",black:"#000000"},firstLoad:true,clone:function(b){var a=function(){};a.prototype=b;return new a()},forEach:function(b,c){var a;for(a in b){if(b.hasOwnProperty(a)&&typeof b[a]!=="function"){c.apply(this,[a,b[a]])}}},locationCache:function(b,a){if(!this.locations.hasOwnProperty(b)){return false}if(!this.locations[b].cache){this.locations[b].cache={}}if(!this.locations[b].cache.hasOwnProperty(a)){this.locations[b].cache[a]={}}return this.locations[b].cache[a]},addAction:function(a,b){if(typeof b!=="function"){return false}if(typeof this.actions[a]!=="object"){this.actions[a]=[b]}else{this.actions[a].push(b)}return true},doAction:function(b){var a,c;if(typeof this.actions[b]!=="object"){return false}a=Array.prototype.slice.apply(arguments,[1]);for(c=0;c<this.actions[b].length;c+=1){if(typeof this.actions[b][c]==="function"){this.actions[b][c].apply(null,a)}}return true},parentScrollToGeoPost:function(){var a;if(this.have_parent_access){a=parent.document.getElementById("gm-post");if(a){parent.focus();parent.scrollTo(a.offsetLeft,a.offsetTop)}}return false},getShowPostElement:function(){if(this.have_parent_access&&!this.show_post_element&&this.opts.name){this.show_post_element=parent.document.getElementById(this.opts.name+"-post")}if(this.have_parent_access&&!this.show_post_element){this.show_post_element=parent.document.getElementById("gm-post")}return this.show_post_element},parentizeLinksMarkup:function(b){var a=document.createElement("div");a.innerHTML=b;this.parentizeLinks(a);return a.innerHTML},parentizeLinks:function(c){var b,a=c.getElementsByTagName("a");if(parent){for(b=0;b<a.length;b+=1){if(a[b].target.length===0||a[b].target==="_self"){a[b].target="_parent"}}}},showLoadingIcon:function(){if(!this.spinner_div.parentNode){this.container.appendChild(this.spinner_div)}},hideLoadingIcon:function(){if(this.spinner_div.parentNode){this.spinner_div.parentNode.removeChild(this.spinner_div)}},getObjectsAtLocation:function(a){return this.locations[a].objects},getMarkerObjects:function(a){return this.getObjectsAtLocation(this.getMarkerLatLng(a))},getMarkerLatLng:function(a){},addGlowMarker:function(a){},openInfoWindow:function(a){},closeInfoWindow:function(a){},removeGlowMarker:function(){},hideAttachments:function(){},showMarkerAttachments:function(a){},loadFullPost:function(a){},selectMarker:function(b){var a=this.getMarkerLatLng(b);this.selected_marker=b;if(this.opts.marker_select_info_window){this.openInfoWindow(b)}if(this.opts.marker_select_attachments){this.showMarkerAttachments(b)}if(this.opts.marker_select_highlight){this.addGlowMarker(b)}if(this.opts.marker_select_center){this.centerMarker(b)}if("full-post"!==this.opts.template&&this.getShowPostElement()){this.loadFullPost(a)}this.doAction("selectedMarker",this.opts,this.selected_marker,this.map)},centerMarker:function(a,b){},deselectMarker:function(){var b,a=GeoMashup.getShowPostElement();if(a){a.innerHTML=""}if(this.glow_marker){this.removeGlowMarker()}if(this.selected_marker){this.closeInfoWindow(this.selected_marker)}this.hideAttachments();this.selected_marker=null},addObjectIcon:function(a){},createMarker:function(a,c){var b;return b},checkDependencies:function(){},clickObjectMarker:function(b,a){},clickMarker:function(b,a){this.clickObjectMarker(b,a)},getCategoryName:function(a){if(!this.opts.term_properties.hasOwnProperty("category")){return null}return this.opts.term_properties.category[a]},hideMarker:function(a){},showMarker:function(a){},hideLine:function(a){},showLine:function(a){},newLatLng:function(b,a){var c;return c},extendLocationBounds:function(){},addMarkers:function(){},makeMarkerMultiple:function(a){},setMarkerImage:function(a,b){},autoZoom:function(){},recluster:function(){},updateMarkerVisibilities:function(){this.forEach(this.locations,function(a,b){GeoMashup.updateMarkerVisibility(b.marker,a)});this.updateVisibleList()},updateMarkerVisibility:function(a){if(this.isMarkerOn(a)){this.showMarker(a)}else{this.hideMarker(a)}},isMarkerOn:function(a){var c,e,b=[],d={visible:false};e=this.getMarkerObjects(a);for(c=0;c<e.length;c+=1){if(this.isObjectOn(e[c])){d.visible=true;b.push(c)}}if(d.visible){if(e.length>1){if(b.length===1){GeoMashup.setMarkerImage(a,e[b[0]].icon.image)}else{GeoMashup.makeMarkerMultiple(a)}}else{if(e[0].combined_term_count>1){if(e[0].visible_term_count===1){jQuery.each(e[0].visible_terms,function(f,g){if(g.length===1){GeoMashup.setMarkerImage(a,GeoMashup.term_manager.getTermData(f,g[0],"icon").image)}})}else{GeoMashup.setMarkerImage(a,e[0].icon.image)}}}}this.doAction("markerVisibilityOptions",this.opts,d,a,this.map);return d.visible},isObjectOn:function(b){var a={visible:false};b.visible_terms={};b.visible_term_count=0;if(!GeoMashup.term_manager||0===b.combined_term_count){a.visible=true}else{jQuery.each(b.terms,function(c,d){b.visible_terms[c]=[];jQuery.each(d,function(e,f){if(GeoMashup.term_manager.getTermData(c,f,"visible")){b.visible_terms[c].push(f);b.visible_term_count+=1;a.visible=true}})})}this.doAction("objectVisibilityOptions",this.opts,a,b,this.map);return a.visible},getOnObjectIDs:function(c){var a,b=[];for(a=0;a<c.length;a+=1){if(this.isObjectOn(c[a])){b.push(c[a].object_id)}}return b},addObjects:function(h,j){var f,b,n,m,a,l,c,e,g,d=[];if(j&&this.term_manager){this.term_manager.reset()}for(f=0;f<h.length;f+=1){n=h[f].object_id;m=this.newLatLng(parseFloat(h[f].lat),parseFloat(h[f].lng));h[f].categories=[];h[f].combined_term_count=0;if(this.term_manager){for(a in h[f].terms){if(h[f].terms.hasOwnProperty(a)&&typeof a!=="function"){l=h[f].terms[a];for(b=0;b<l.length;b+=1){GeoMashup.term_manager.extendTerm(m,a,l[b],h[f])}h[f].combined_term_count+=l.length;if("category"===a){h[f].categories=l}}}}if(this.opts.max_posts&&this.object_count>=this.opts.max_posts){break}if(!this.objects[n]){this.objects[n]=h[f];this.object_count+=1;if(!this.locations[m]){this.extendLocationBounds(m);this.locations[m]={objects:[h[f]],loaded_content:{}};e=this.createMarker(m,h[f]);this.objects[n].marker=e;this.locations[m].marker=e;d.push(e)}else{this.locations[m].objects.push(h[f]);e=this.locations[m].marker;this.makeMarkerMultiple(e);this.objects[n].marker=e;this.addObjectIcon(this.objects[n])}}}this.addMarkers(d);if(this.term_manager){this.term_manager.populateTermElements()}if(this.firstLoad){this.firstLoad=false;if(this.opts.auto_info_open&&this.object_count>0){if(!this.opts.open_object_id){if(this.opts.context_object_id&&this.objects[this.opts.context_object_id]){this.opts.open_object_id=this.opts.context_object_id}else{this.opts.open_object_id=h[0].object_id}}this.clickObjectMarker(this.opts.open_object_id)}if(this.opts.zoom==="auto"){this.autoZoom()}else{if(this.opts.context_object_id&&this.objects[this.opts.context_object_id]){this.centerMarker(this.objects[this.opts.context_object_id].marker,parseInt(this.opts.zoom,10))}this.updateVisibleList()}}},requestObjects:function(a){},hideMarkers:function(){var a;for(a in this.locations){if(this.locations.hasOwnProperty(a)&&this.locations[a].marker){this.hideMarker(this.locations[a].marker)}}this.recluster();this.updateVisibleList()},showMarkers:function(){jQuery.each(this.locations,function(a,b){if(GeoMashup.isMarkerOn(b.marker)){GeoMashup.showMarker(b.marker)}});this.recluster();this.updateVisibleList()},adjustZoom:function(){var a,b;b=this.map.getZoom();if(typeof this.last_zoom_level==="undefined"){this.last_zoom_level=b}a=this.last_zoom_level;if(this.term_manager){this.term_manager.updateLineZoom(a,b)}if(this.clusterer&&"google"===this.opts.map_api){if(a<=this.opts.cluster_max_zoom&&b>this.opts.cluster_max_zoom){this.clusterer.clusteringEnabled=false;this.clusterer.refresh(true)}else{if(a>this.opts.cluster_max_zoom&&b<=this.opts.cluster_max_zoom){this.clusterer.clusteringEnabled=true;this.clusterer.refresh(true)}}}this.last_zoom_level=b},objectLinkHtml:function(a){return['<a href="#',this.opts.name,'" onclick="frames[\'',this.opts.name,"'].GeoMashup.clickObjectMarker(",a,');">',this.objects[a].title,"</a>"].join("")},isMarkerVisible:function(a){return false},updateVisibleList:function(){var d,c,a,b=0;if(this.have_parent_access&&this.opts.name){c=parent.document.getElementById(this.opts.name+"-visible-list-header");d=parent.document.getElementById(this.opts.name+"-visible-list")}if(c){c.style.display="block"}if(d){a=['<ul class="gm-visible-list">'];this.forEach(this.objects,function(f,e){if(this.isObjectOn(e)&&this.isMarkerVisible(e.marker)){a.push('<li><img src="');a.push(e.icon.image);a.push('" alt="');a.push(e.title);a.push('" />');a.push(this.objectLinkHtml(f));a.push("</li>");b+=1}});a.push("</ul>");d.innerHTML=a.join("");this.doAction("updatedVisibleList",this.opts,b)}},adjustViewport:function(){this.updateVisibleList()},createMap:function(a,b){}};